{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 16, "column": 0}, "map": {"version":3,"sources":["file:///Users/daveonthetrack/Projects/Finote%20Loza/finote-loza-school/pages/api/admin/students/detail.js"],"sourcesContent":["import { createClient } from '@supabase/supabase-js';\n\nexport default async function handler(req, res) {\n  if (req.method !== 'GET') {\n    return res.status(405).json({ error: 'Method not allowed' });\n  }\n\n  try {\n    const { id } = req.query || {};\n    if (!id) return res.status(400).json({ error: 'Missing student id' });\n\n    const url = process.env.NEXT_PUBLIC_SUPABASE_URL;\n    const key = process.env.SUPABASE_SERVICE_ROLE_KEY;\n    if (!url || !key) return res.status(500).json({ error: 'Server misconfigured' });\n    const supabase = createClient(url, key);\n\n    const { data: student, error: sErr } = await supabase\n      .from('students')\n      .select('*')\n      .eq('id', id)\n      .single();\n    if (sErr) return res.status(400).json({ error: sErr.message });\n\n    // Get first linked parent if any\n    const { data: links, error: lErr } = await supabase\n      .from('parent_students')\n      .select('parents:parents(*)')\n      .eq('student_id', id)\n      .limit(1);\n    if (lErr) return res.status(400).json({ error: lErr.message });\n    const parent = links && links.length > 0 ? links[0].parents : null;\n\n    return res.status(200).json({ student, parent });\n  } catch (e) {\n    return res.status(500).json({ error: 'Internal server error' });\n  }\n}\n\n\n\n\n"],"names":[],"mappings":";;;;AAAA;;AAEe,eAAe,QAAQ,GAAG,EAAE,GAAG;IAC5C,IAAI,IAAI,MAAM,KAAK,OAAO;QACxB,OAAO,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;YAAE,OAAO;QAAqB;IAC5D;IAEA,IAAI;QACF,MAAM,EAAE,EAAE,EAAE,GAAG,IAAI,KAAK,IAAI,CAAC;QAC7B,IAAI,CAAC,IAAI,OAAO,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;YAAE,OAAO;QAAqB;QAEnE,MAAM;QACN,MAAM,MAAM,QAAQ,GAAG,CAAC,yBAAyB;QACjD,IAAI,CAAC,OAAO,CAAC,KAAK,OAAO,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;YAAE,OAAO;QAAuB;QAC9E,MAAM,WAAW,IAAA,gRAAY,EAAC,KAAK;QAEnC,MAAM,EAAE,MAAM,OAAO,EAAE,OAAO,IAAI,EAAE,GAAG,MAAM,SAC1C,IAAI,CAAC,YACL,MAAM,CAAC,KACP,EAAE,CAAC,MAAM,IACT,MAAM;QACT,IAAI,MAAM,OAAO,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;YAAE,OAAO,KAAK,OAAO;QAAC;QAE5D,iCAAiC;QACjC,MAAM,EAAE,MAAM,KAAK,EAAE,OAAO,IAAI,EAAE,GAAG,MAAM,SACxC,IAAI,CAAC,mBACL,MAAM,CAAC,sBACP,EAAE,CAAC,cAAc,IACjB,KAAK,CAAC;QACT,IAAI,MAAM,OAAO,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;YAAE,OAAO,KAAK,OAAO;QAAC;QAC5D,MAAM,SAAS,SAAS,MAAM,MAAM,GAAG,IAAI,KAAK,CAAC,EAAE,CAAC,OAAO,GAAG;QAE9D,OAAO,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;YAAE;YAAS;QAAO;IAChD,EAAE,OAAO,GAAG;QACV,OAAO,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;YAAE,OAAO;QAAwB;IAC/D;AACF"}}]
}